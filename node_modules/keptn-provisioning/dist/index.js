"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.provisioning = void 0;
const js_yaml_1 = require("js-yaml");
const kube_port_forward_1 = require("./kube/kube-port-forward");
const main_1 = require("./update/main");
async function provisioning(config, keptnAuth = '', kubeSettings = `{"enabled": false}`) {
    const settingsObject = (0, js_yaml_1.load)(config);
    const settings = settingsObject;
    const kubeConnectObject = (0, js_yaml_1.load)(kubeSettings);
    const kubeConnect = kubeConnectObject;
    if (kubeConnect.enabled) {
        console.log('GLOBAL: Update services with Kubernetes connection.');
        console.log(`KUBE: KubeAPISettings: ${JSON.stringify(kubeConnectObject)}`);
        return await (0, kube_port_forward_1.kubeUpdateService)(kubeConnect, settings);
    }
    else {
        console.log('GLOBAL: Update services with API URL and token.');
        return (0, main_1.updateResources)((0, js_yaml_1.load)(keptnAuth), settings);
    }
}
exports.provisioning = provisioning;
